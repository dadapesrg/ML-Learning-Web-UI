<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload JSON for ML Prediction</title>

    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .container { width: 50%; margin: auto; }
        input[type="file"] { margin: 10px 0; }
        button { padding: 10px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
        pre { background-color: #f4f4f4; padding: 15px; white-space: pre-wrap; word-wrap: break-word; }
    </style>
    <!-- Link to the external CSS file -->
    <!--<link rel="stylesheet" href="style.css"> -->
    <!-- Other head content -->
    <link rel="icon" href="data:,">
</head>
<body>
    <div class="container">
        <h1>Upload JSON File for ML Prediction</h1>
        <input type="file" id="fileInput" accept=".json"><br><br>
        <button onclick="uploadFile()">Submit for Prediction</button>
        <h3>Prediction Result:</h3>
        <pre id="result">No result yet...</pre>
    </div>

    <script>
        // Function to handle the file upload and send data to the backend
        function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];

            if (!file) {
                document.getElementById('result').innerText = 'Please select a file!';
                return;
            }

            const reader = new FileReader();
            reader.onload = async function(event) {
                try {
                    const fileContent = event.target.result;
                    const jsonData = JSON.parse(fileContent);  // Parse JSON

                    // Send the JSON data to the backend for prediction
                    const response = await fetch('https://electricity-demand-forecasting-1010694068842.us-central1.run.app/predict', { // communicate with backend ML service URL
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(jsonData)  // Send the JSON content
                    });

                    const result = await response.json();

                    // Display the result in the UI
                    document.getElementById('result').innerText = JSON.stringify(result, null, 2);

                } catch (error) {
                    console.error('Error:', error);
                    document.getElementById('result').innerText = 'Error occurred: ' + error.message;
                }
            };

            // Read the file content as a text
            reader.readAsText(file);
        }
    </script>
</body>
</html>
